(function(){var t={3930:function(t,s,e){"use strict";e(3627);var i=e(797),n=(e(1746),e(2628)),a=(e(3322),e(9245)),r=(e(6705),e(6790)),o=(e(9067),e(5947)),l=(e(210),e(4639)),c=(e(7228),e(9864)),u=(e(5825),e(9858)),d=(e(7322),e(6631)),h=(e(4349),e(32)),p=(e(8554),e(3946)),f=e(6369),m=function(){var t=this,s=t._self._c;return s("div",[s("router-view")],1)},v=[],g=e(1001),y={},_=(0,g.Z)(y,m,v,!1,null,null,null),w=_.exports,L=(e(1305),e(2631)),b=function(){var t=this,s=t._self._c;return s("div",[s("van-nav-bar",{attrs:{title:t.activeTitle,fixed:""}}),s("div",{staticClass:"main"},[s("router-view")],1),s("van-tabbar",{attrs:{route:""}},[s("van-tabbar-item",{attrs:{replace:"",to:"/layout/home",icon:"home-o"}},[t._v("首页")]),s("van-tabbar-item",{attrs:{replace:"",to:"/layout/search",icon:"search"}},[t._v("搜索")])],1)],1)},Z=[],C={data(){return{activeTitle:this.$route.meta.title}},watch:{$route(){this.activeTitle=this.$route.meta.title}}},S=C,x=(0,g.Z)(S,b,Z,!1,null,"795f0acf",null),k=x.exports,$=function(){var t=this,s=t._self._c;return s("div",[s("p",{staticClass:"title"},[t._v("推荐歌单")]),s("van-row",{attrs:{gutter:"6"}},t._l(t.relist,(function(e){return s("van-col",{key:e.id,attrs:{span:"8"}},[s("van-image",{attrs:{width:"100%",height:"3rem",fit:"cover",src:e.picUrl}}),s("p",{staticClass:"song_name"},[t._v(" "+t._s(e.name)+" ")])],1)})),1),s("div",{staticClass:"title"},[t._v("最新音乐")]),t._l(t.songList,(function(t){return s("SongItem",{key:t.id,attrs:{name:t.name,author:t.song.artists[0].name,id:t.id}})}))],2)},P=[],I=function(){var t=this,s=t._self._c;return s("div",[s("van-cell",{attrs:{center:"",title:t.name,label:t.author+"-"+t.name},scopedSlots:t._u([{key:"right-icon",fn:function(){return[s("van-icon",{attrs:{name:"play-circle-o",size:"0.7rem"},on:{click:t.playFn}})]},proxy:!0}])})],1)},O=[],E=(e(7658),{props:{name:String,author:String,id:Number},methods:{playFn(){this.$router.push({path:"/play",query:{id:this.id}})}}}),T=E,F=(0,g.Z)(T,I,O,!1,null,"04cdeb40",null),z=F.exports,j=e(6265),q=e.n(j);q().defaults.baseURL="http://localhost:3000";var U=q();const D=t=>U({url:"/personalized",params:t}),M=t=>U({url:"/personalized/newsong",params:t}),N=t=>U({url:"/search/hot",params:t}),G=t=>U({url:"/cloudsearch",params:t}),R=t=>U({url:`/song/detail?ids=${t}`,method:"GET"}),V=t=>U({url:`/lyric?id=${t}`,method:"GET"}),H=D,W=M,A=N,B=G,J=R,K=V;var Q={components:{SongItem:z},data(){return{relist:[],songList:[]}},async created(){const t=await H({limit:6}),s=await W({limit:20});console.log(t),console.log(s),this.relist=t.data.result,this.songList=s.data.result}},X=Q,Y=(0,g.Z)(X,$,P,!1,null,"17040a01",null),tt=Y.exports,st=function(){var t=this,s=t._self._c;return s("div",[s("van-search",{attrs:{shape:"round",placeholder:"请输入搜索关键词"},on:{input:t.inputFn},model:{value:t.value,callback:function(s){t.value=s},expression:"value"}}),0===t.resultList.length?s("div",{staticClass:"search_wrap"},[s("p",{staticClass:"hot_title"},[t._v("热门搜索")]),s("div",{staticClass:"hot_name_wrap"},t._l(t.hotList,(function(e,i){return s("span",{key:i,staticClass:"hot_item",on:{click:function(s){return t.fn(e.first)}}},[t._v(" "+t._s(e.first)+" ")])})),0)]):s("div",{staticClass:"search_wrap"},[s("p",{staticClass:"hot_title"},[t._v("最佳匹配")]),s("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.loading,callback:function(s){t.loading=s},expression:"loading"}},t._l(t.resultList,(function(t){return s("SongItem",{key:t.id,attrs:{name:t.name,author:t.ar[0].name,id:t.id}})})),1)],1)],1)},et=[],it={components:{SongItem:z},data(){return{value:"",hotList:[],resultList:[],loading:!1,finished:!1,page:1,timer:null}},async created(){const t=await A();console.log(t),this.hotList=t.data.result.hots},methods:{async getListFn(){return await B({keywords:this.value,limit:20,offset:20*(this.page-1)})},async fn(t){this.page=1,this.finished=!1,this.value=t;const s=await this.getListFn();console.log(s),this.resultList=s.data.result.songs,this.loading=!1},async inputFn(){this.page=1,this.timer&&clearTimeout(this.timer),this.timer=setTimeout((async()=>{if(this.finished=!1,0==this.value.trim().length)return void(this.resultList=[]);const t=await this.getListFn();void 0!==t.data.result.songs?(console.log(t),this.resultList=t.data.result.songs,this.loading=!1):this.resultList=[]}),900)},async onLoad(){this.page++;const t=await this.getListFn();if(void 0===t.data.result.songs)return this.finished=!0,void(this.loading=!1);this.resultList=[...this.resultList,...t.data.result.songs],this.loading=!1}}},nt=it,at=(0,g.Z)(nt,st,et,!1,null,"25bed8e9",null),rt=at.exports,ot=function(){var t=this,s=t._self._c;return s("div",{staticClass:"play"},[s("div",{staticClass:"song-bg",style:`background-image: url(${t.songInfo&&t.songInfo.al&&t.songInfo.al.picUrl}?imageView&thumbnail=360y360&quality=75&tostatic=0);`}),s("div",{staticClass:"header"},[s("van-icon",{staticClass:"left-incon",attrs:{name:"arrow-left",size:"20"},on:{click:function(s){return t.$router.back()}}})],1),s("div",{staticClass:"song-wrapper"},[s("div",{staticClass:"song-turn ani",style:"animation-play-state:"+(t.playState?"running":"paused")},[s("div",{staticClass:"song-img"},[s("img",{staticStyle:{width:"100%"},attrs:{src:`${t.songInfo&&t.songInfo.al&&t.songInfo.al.picUrl}?imageView&thumbnail=360y360&quality=75&tostatic=0`,alt:""}})])]),s("div",{staticClass:"start-box",on:{click:t.audioStart}},[s("span",{directives:[{name:"show",rawName:"v-show",value:!t.playState,expression:"!playState"}],staticClass:"song-start"})]),s("div",{staticClass:"song-msg"},[s("h2",{staticClass:"m-song-h2"},[s("span",{staticClass:"m-song-sname"},[t._v(t._s(t.songInfo.name)+"-"+t._s(t.songInfo&&t.songInfo.ar&&t.songInfo.ar[0].name))])]),s("div",{staticClass:"lrcContent"},[s("p",{staticClass:"lrc"},[t._v(t._s(t.curLyric))])])]),s("div",{staticClass:"needle",style:`transform: rotate(${t.needleDeg});`})]),s("audio",{ref:"audio",attrs:{preload:"true",src:`https://music.163.com/song/media/outer/url?id=${t.id}.mp3`}})])},lt=[],ct={components:{[u.Z.name]:u.Z},name:"play",data(){return{playState:!1,id:this.$route.query.id,songInfo:{},lyric:{},curLyric:"",lastLy:""}},computed:{needleDeg(){return this.playState?"-7deg":"-38deg"}},methods:{async getSong(){const t=await J(this.id);this.songInfo=t.data.songs[0];const s=await K(this.id),e=s.data.lrc.lyric;this.lyric=this._formatLyr(e),this.curLyric=this.lyric[0]},_formatLyr(t){let s=/\[.+?\]/g,e=t.match(s);console.log(e);let i=t.split(/\[.+?\]/).slice(1);console.log(i);let n={};return e.forEach(((t,s)=>{let e=60*t.split(":")[0].split("")[2],a="0"===t.split(":")[1].split(".")[0].split("")[0]?t.split(":")[1].split(".")[0].split("")[1]:t.split(":")[1].split(".")[0];n[e+Number(a)]=i[s]})),console.log(n),n},audioStart(){this.playState?this.$refs.audio.pause():this.$refs.audio.play(),this.playState=!this.playState},showLyric(){this.$refs.audio.addEventListener("timeupdate",(()=>{let t=Math.floor(this.$refs.audio.currentTime);this.lyric[t]?(this.curLyric=this.lyric[t],this.lastLy=this.curLyric):this.curLyric=this.lastLy}))}},mounted(){this.getSong(),this.showLyric(),console.log(this.$route.query.id)}},ut=ct,dt=(0,g.Z)(ut,ot,lt,!1,null,"375fb5d2",null),ht=dt.exports;f.ZP.use(L.Z);const pt=[{path:"/",redirect:"/layout"},{path:"/layout",component:k,children:[{path:"home",component:tt,meta:{title:"首页"}},{path:"search",component:rt,meta:{title:"搜索"}}]},{path:"/play",component:ht}];var ft=new L.Z({routes:pt});async function mt(){const t=await H();console.log(t)}mt(),f.ZP.use(p.Z),f.ZP.use(h.Z),f.ZP.use(d.Z),f.ZP.use(u.Z),f.ZP.use(c.Z),f.ZP.use(l.Z),f.ZP.use(o.Z),f.ZP.use(r.Z),f.ZP.use(a.Z),f.ZP.use(n.Z),f.ZP.use(i.Z),f.ZP.config.productionTip=!1,new f.ZP({router:ft,render:t=>t(w)}).$mount("#app")},1305:function(){(function(t,s){var e=s.documentElement,i=t.devicePixelRatio||1;function n(){s.body?s.body.style.fontSize=12*i+"px":s.addEventListener("DOMContentLoaded",n)}function a(){var t=e.clientWidth/10;e.style.fontSize=t+"px"}if(n(),a(),t.addEventListener("resize",a),t.addEventListener("pageshow",(function(t){t.persisted&&a()})),i>=2){var r=s.createElement("body"),o=s.createElement("div");o.style.border=".5px solid transparent",r.appendChild(o),e.appendChild(r),1===o.offsetHeight&&e.classList.add("hairlines"),e.removeChild(r)}})(window,document)}},s={};function e(i){var n=s[i];if(void 0!==n)return n.exports;var a=s[i]={exports:{}};return t[i](a,a.exports,e),a.exports}e.m=t,function(){var t=[];e.O=function(s,i,n,a){if(!i){var r=1/0;for(u=0;u<t.length;u++){i=t[u][0],n=t[u][1],a=t[u][2];for(var o=!0,l=0;l<i.length;l++)(!1&a||r>=a)&&Object.keys(e.O).every((function(t){return e.O[t](i[l])}))?i.splice(l--,1):(o=!1,a<r&&(r=a));if(o){t.splice(u--,1);var c=n();void 0!==c&&(s=c)}}return s}a=a||0;for(var u=t.length;u>0&&t[u-1][2]>a;u--)t[u]=t[u-1];t[u]=[i,n,a]}}(),function(){e.n=function(t){var s=t&&t.__esModule?function(){return t["default"]}:function(){return t};return e.d(s,{a:s}),s}}(),function(){e.d=function(t,s){for(var i in s)e.o(s,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:s[i]})}}(),function(){e.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){e.o=function(t,s){return Object.prototype.hasOwnProperty.call(t,s)}}(),function(){var t={143:0};e.O.j=function(s){return 0===t[s]};var s=function(s,i){var n,a,r=i[0],o=i[1],l=i[2],c=0;if(r.some((function(s){return 0!==t[s]}))){for(n in o)e.o(o,n)&&(e.m[n]=o[n]);if(l)var u=l(e)}for(s&&s(i);c<r.length;c++)a=r[c],e.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return e.O(u)},i=self["webpackChunkmusic_demo"]=self["webpackChunkmusic_demo"]||[];i.forEach(s.bind(null,0)),i.push=s.bind(null,i.push.bind(i))}();var i=e.O(void 0,[998],(function(){return e(3930)}));i=e.O(i)})();
//# sourceMappingURL=app.176c3025.js.map